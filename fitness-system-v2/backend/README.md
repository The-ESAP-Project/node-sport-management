# å­¦ç”Ÿä½“æµ‹ç®¡ç†ç³»ç»Ÿåç«¯

åŸºäº TypeScript + Express + PostgreSQL + Redis æ„å»ºçš„å­¦ç”Ÿä½“æµ‹æ•°æ®ç®¡ç†ç³»ç»Ÿåç«¯æœåŠ¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **ç”¨æˆ·è®¤è¯**: JWTä»¤ç‰Œè®¤è¯ï¼Œæ”¯æŒç®¡ç†å‘˜å’Œç­çº§è´¦å·
- ğŸ‘¥ **ç”¨æˆ·ç®¡ç†**: ç”¨æˆ·CRUDã€æƒé™æ§åˆ¶ã€æ‰¹é‡åˆ›å»ºç­çº§è´¦å·
- ğŸ« **ç­çº§ç®¡ç†**: ç­çº§ä¿¡æ¯ç®¡ç†ã€ç»Ÿè®¡åŠŸèƒ½
- ğŸ‘¨â€ğŸ“ **å­¦ç”Ÿç®¡ç†**: å­¦ç”Ÿä¿¡æ¯ç®¡ç†ã€æ‰¹é‡å¯¼å…¥
- ğŸ“Š **ä½“æµ‹æ•°æ®**: 9é¡¹ä½“æµ‹æ•°æ®ç®¡ç†ã€ç»Ÿè®¡åˆ†æã€æ’åè®¡ç®—
- ğŸ“‹ **Excelå¤„ç†**: Excelå¯¼å…¥å¯¼å‡ºã€æ•°æ®é¢„è§ˆã€æ¨¡æ¿ä¸‹è½½
- ğŸ” **æ•°æ®éªŒè¯**: å®Œæ•´çš„æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†
- ğŸ“ˆ **ç»Ÿè®¡åˆ†æ**: ç­çº§ç»Ÿè®¡ã€å¹´çº§è¶‹åŠ¿åˆ†æ
- âš¡ **ç¼“å­˜æœºåˆ¶**: Redisç¼“å­˜ä¼˜åŒ–æ€§èƒ½

## æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: Express.js + TypeScript
- **æ•°æ®åº“**: PostgreSQL (Sequelize ORM)
- **ç¼“å­˜**: Redis
- **è®¤è¯**: JWT
- **æ–‡ä»¶å¤„ç†**: ExcelJS + Multer
- **æ—¥å¿—**: Winston
- **éªŒè¯**: Express Validator
- **å®‰å…¨**: Helmet + CORS + Rate Limiting

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Node.js >= 16.x
- PostgreSQL >= 12.x
- Redis >= 6.x

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. ç¯å¢ƒé…ç½®

å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“å’ŒRedisè¿æ¥ä¿¡æ¯ã€‚

### 4. æ•°æ®åº“åˆå§‹åŒ–

ç¡®ä¿PostgreSQLæœåŠ¡å·²å¯åŠ¨ï¼Œåˆ›å»ºæ•°æ®åº“ï¼š
```sql
CREATE DATABASE fitness_system;
```

### 5. å¯åŠ¨æœåŠ¡

å¼€å‘ç¯å¢ƒï¼š
```bash
npm run dev
```

ç”Ÿäº§ç¯å¢ƒï¼š
```bash
npm run build
npm start
```

## APIæ–‡æ¡£

æœåŠ¡å¯åŠ¨åè®¿é—®ï¼š`http://localhost:3001/api/v1/docs`

### ä¸»è¦APIç«¯ç‚¹

#### è®¤è¯ç›¸å…³
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/logout` - ç”¨æˆ·ç™»å‡º
- `GET /api/v1/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `POST /api/v1/auth/change-password` - ä¿®æ”¹å¯†ç 

#### ç”¨æˆ·ç®¡ç†
- `POST /api/v1/users` - åˆ›å»ºç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/v1/users` - è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆç®¡ç†å‘˜ï¼‰
- `POST /api/v1/users/batch/class` - æ‰¹é‡åˆ›å»ºç­çº§è´¦å·ï¼ˆç®¡ç†å‘˜ï¼‰

#### ç­çº§ç®¡ç†
- `POST /api/v1/classes` - åˆ›å»ºç­çº§ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/v1/classes` - è·å–ç­çº§åˆ—è¡¨
- `GET /api/v1/classes/:id/stats` - è·å–ç­çº§ç»Ÿè®¡ä¿¡æ¯

#### å­¦ç”Ÿç®¡ç†
- `POST /api/v1/students` - åˆ›å»ºå­¦ç”Ÿ
- `GET /api/v1/students/class/:classID` - æ ¹æ®ç­çº§è·å–å­¦ç”Ÿåˆ—è¡¨
- `POST /api/v1/students/batch/import` - æ‰¹é‡å¯¼å…¥å­¦ç”Ÿ

#### ä½“æµ‹æ•°æ®
- `PUT /api/v1/sport-data/student/:studentID/year/:year` - åˆ›å»ºæˆ–æ›´æ–°ä½“æµ‹æ•°æ®
- `GET /api/v1/sport-data/class/:classID/year/:year/stats` - è·å–ç­çº§ä½“æµ‹ç»Ÿè®¡
- `POST /api/v1/sport-data/rankings/year/:year` - è®¡ç®—æ’åï¼ˆç®¡ç†å‘˜ï¼‰

#### Excelå¤„ç†
- `POST /api/v1/excel/upload/preview` - ä¸Šä¼ å¹¶é¢„è§ˆExcel
- `POST /api/v1/excel/import/confirm` - ç¡®è®¤å¯¼å…¥Excelæ•°æ®
- `GET /api/v1/excel/template/download` - ä¸‹è½½å¯¼å…¥æ¨¡æ¿

## æ•°æ®æ¨¡å‹

### ç”¨æˆ·è¡¨ (User)
- æ”¯æŒç®¡ç†å‘˜å’Œç­çº§è´¦å·ä¸¤ç§è§’è‰²
- ç­çº§è´¦å·æ ¼å¼ï¼šå¹´çº§-ç­çº§å

### å­¦ç”Ÿè¡¨ (Student)
- å­¦ç±å·ã€å§“åã€æ€§åˆ«ã€æ°‘æ—ã€ç”Ÿæ—¥ç­‰åŸºæœ¬ä¿¡æ¯
- è½¯åˆ é™¤æœºåˆ¶

### ä½“æµ‹æ•°æ®è¡¨ (SportData)
- å®½è¡¨è®¾è®¡ï¼ŒåŒ…å«9é¡¹ä½“æµ‹æ•°æ®
- è‡ªåŠ¨è®¡ç®—æ€»åˆ†å’Œæ’å

### ç­çº§è¡¨ (ClassInfo)
- ç­çº§åŸºæœ¬ä¿¡æ¯å’Œå­¦å¹´ç®¡ç†

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app.ts              # åº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ server.ts           # æœåŠ¡å¯åŠ¨æ–‡ä»¶
â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”œâ”€â”€ controllers/        # æ§åˆ¶å™¨
â”œâ”€â”€ middleware/         # ä¸­é—´ä»¶
â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”œâ”€â”€ routes/             # è·¯ç”±
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ types/              # ç±»å‹å®šä¹‰
â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
```

### å¼€å‘å‘½ä»¤

```bash
npm run dev          # å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm start            # å¯åŠ¨ç”Ÿäº§æœåŠ¡
npm run lint         # ä»£ç æ£€æŸ¥
npm test             # è¿è¡Œæµ‹è¯•
```

### æ•°æ®åº“è¿ç§»

```bash
npm run db:migrate   # è¿è¡Œæ•°æ®åº“è¿ç§»
npm run db:seed      # è¿è¡Œæ•°æ®ç§å­
```

## éƒ¨ç½²

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t fitness-system-backend .

# è¿è¡Œå®¹å™¨
docker run -p 3001:3001 --env-file .env fitness-system-backend
```

### ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹

1. ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
2. è®¾ç½®å¼ºJWTå¯†é’¥
3. é…ç½®HTTPS
4. è®¾ç½®åˆé€‚çš„CORSç­–ç•¥
5. é…ç½®æ—¥å¿—è½®è½¬
6. è®¾ç½®æ•°æ®åº“è¿æ¥æ± 
7. é…ç½®RedisæŒä¹…åŒ–

## é»˜è®¤è´¦å·

ç³»ç»Ÿé¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼š
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123456`

**è¯·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼**

## è®¸å¯è¯

MIT License
